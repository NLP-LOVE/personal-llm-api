
# ğŸ†Personal LLM API

Personal LLM API æ˜¯ä¸€æ¬¾è½»é‡çº§çš„ LLM æ¥å£æœåŠ¡ï¼Œä¸ [one-api](https://github.com/songquanpeng/one-api) ç›¸æ¯”ï¼Œæœ¬é¡¹ç›®æ›´åŠ ç®€æ´æ˜“ç”¨ï¼Œä¸“ä¸ºä¸ªäººç”¨æˆ·æ‰“é€ ç»Ÿä¸€çš„ LLM æ¥å£ç®¡ç†æ–¹æ¡ˆã€‚åŸºäº Python å¼€å‘ï¼Œé‡‡ç”¨ FastAPI æ¡†æ¶å®ç°é«˜æ€§èƒ½æ¥å£æœåŠ¡ï¼Œåå°ç®¡ç†ç•Œé¢ä½¿ç”¨ amis ä½ä»£ç å¼€å‘ï¼Œæ— éœ€å¤æ‚çš„å‰ç«¯æŠ€æœ¯å³å¯å¿«é€Ÿæ„å»ºç®¡ç†æ§åˆ¶å°ã€‚

**ğŸš€ä¸ºä»€ä¹ˆè¦å¼€å‘è¿™æ ·çš„é¡¹ç›®ï¼š**
- **æè‡´çš„äº¤äº’é€‚é…ï¼š** æœ¬é¡¹ç›®æ·±åº¦ä¼˜åŒ–äº†æµå¼è¾“å‡ºåè®®ï¼Œæ˜¯ Cherry Studio ç­‰é«˜é¢œå€¼å®¢æˆ·ç«¯çš„ç»ä½³æ‹æ¡£ã€‚å®Œç¾æ”¯æŒâ€œæ‰“å­—æœºâ€æµå¼å“åº”ï¼Œè®©æ¯ä¸€è¡Œä¸æ»‘çš„è¾“å‡ºéƒ½èƒ½åŒ¹é…å…¶ç²¾è‡´çš„ä¸»é¢˜ä¸å­—ä½“è®¾è®¡ï¼Œæ‰“é€ æ²‰æµ¸å¼å¯¹è¯ä½“éªŒã€‚
- **å¤šæ¨¡å‹èšåˆè°ƒåº¦ï¼š** å¸‚é¢ä¸Šçš„å¤§æ¨¡å‹æ¥å£æä¾›å•†éå¸¸å¤šï¼Œä¼˜æƒ åŠ›åº¦ä¹Ÿæœ‰å·®å¼‚ï¼Œæœ¬é¡¹ç›®ç»Ÿä¸€ç®¡ç†è‡ªå·±çš„ LLM æ¥å£ï¼Œèƒ½å¤Ÿæ›´æ–¹ä¾¿åœ°è¿›è¡Œä½¿ç”¨ã€åˆ‡æ¢å’Œç›‘æ§ã€‚
- **é«˜åº¦è‡ªç”±ï¼š** è€ƒè™‘åˆ°ä¸ªäººä½¿ç”¨åœºæ™¯ï¼Œä½¿ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæœ¬é¡¹ç›®èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„è¿›è¡ŒäºŒæ¬¡å¼€å‘æ‰©å±•ã€‚

**é¡¹ç›®ç‰¹ç‚¹ï¼š**
- ğŸ§¿æç®€æ¶æ„ï¼šæ ¸å¿ƒä»£ç ç²¾ç®€ï¼Œæ˜“äºç†è§£å’Œéƒ¨ç½²
- ğŸPython åŸç”Ÿï¼šå…¨æ ˆ Python å®ç°ï¼Œé™ä½æŠ€æœ¯æ ˆå¤æ‚åº¦
- ğŸ“œä½ä»£ç åå°ç®¡ç†ï¼šåŸºäº [amis](https://aisuda.bce.baidu.com/amis/zh-CN/docs/index) æ„å»ºçš„ç®¡ç†ç•Œé¢ï¼Œå¯è§†åŒ–é…ç½®æ›´é«˜æ•ˆ
- ğŸ›é«˜åº¦å¯æ‰©å±•ï¼šåå°ç®¡ç†æ”¯æŒè½»æ¾æ·»åŠ æ–°çš„æ¨¡å‹æä¾›å•†å’Œæ¥å£ï¼›è½»æ¾æ‰©å±•å®šåˆ¶åŒ–ä»£ç ä¸åŠŸèƒ½ã€‚
- ğŸ‘©â€ğŸ’»ä¸ªäººå‹å¥½ï¼šèµ„æºå ç”¨ä½ï¼Œé€‚åˆä¸ªäººæœåŠ¡å™¨éƒ¨ç½²ï¼Œè¿è¡Œ Python å…¥å£æ–‡ä»¶å³å¯ã€‚
- ğŸ“±å¯æ­é…å„ç§ LLM å¯¹è¯å®¢æˆ·ç«¯ï¼šå¯ä¸ [Cherry studio](https://www.cherry-ai.com/) ã€[Lobe-Chat](https://lobechat.com/chat)ã€[ChatBox](https://chatboxai.app/zh/)ç­‰åº”ç”¨æ— ç¼é›†æˆï¼Œæ‰©å±•åº”ç”¨åœºæ™¯

æ”¯æŒå¤šç§ä¸»æµæ¨¡å‹æä¾›å•†ï¼ˆç«å±±äº‘ã€é˜¿é‡Œäº‘ã€ç¡…åŸºæµåŠ¨ã€OpenRouter ç­‰ï¼‰ï¼Œå…¼å®¹ OpenAI API è§„èŒƒï¼Œæä¾›æµå¼/éæµå¼å“åº”ã€Web æœç´¢(ç«å±±äº‘responseæ¥å£)é›†æˆç­‰æ ¸å¿ƒåŠŸèƒ½ï¼Œæ˜¯ä¸ªäººå¼€å‘è€…å¿«é€Ÿéƒ¨ç½²ç»Ÿä¸€ LLM æ¥å£çš„ç†æƒ³é€‰æ‹©ã€‚
        


## ç‰¹æ€§

- âœ…ï¸æ”¯æŒ `/v1/chat/completions`å’Œ`/chat/completions`çš„ OpenAI æ¥å£è§„èŒƒã€‚
- âœ…ï¸æ”¯æŒç«å±±äº‘`web search`çš„`response`æ¥å£è½¬æ¢æˆæ™®é€šçš„`chat`æ¥å£æ–¹å¼ï¼Œæ˜“äºæ¥å…¥`Cherry studio`ç­‰å®¢æˆ·ç«¯ã€‚
- âœ…ï¸æ”¯æŒ`Nano Banana Pro`ã€‚
- âœ…ï¸æ”¯æŒå¤§éƒ¨åˆ†çš„ LLM æœåŠ¡æä¾›å•†ã€‚
- âœ…ï¸æ”¯æŒç›¸åŒæ¨¡å‹ä¸‹çš„è½®è¯¢è´Ÿè½½å‡è¡¡ã€‚
- âœ…ï¸æ”¯æŒåå°ç®¡ç†ç•Œé¢(ä½¿ç”¨ç»Ÿè®¡ã€æ¨¡å‹ç®¡ç†ã€å¯¹è¯å†å²ã€key ç®¡ç†ç­‰)ã€‚
- âœ…ï¸æ”¯æŒ`sqlite`æˆ–`mysql`å­˜å‚¨ã€‚
- âœ…ï¸æ”¯æŒè®¾ç½®`proxy`ä»£ç†è®¿é—®ã€‚
- âœ…ï¸æ–¹ä¾¿ä¸ªäººä½¿ç”¨å’Œéƒ¨ç½²ï¼Œä¸æ”¯æŒå¤šç§Ÿæˆ·è®¾è®¡ã€‚
- âœ…ï¸åå°ç•Œé¢ä½¿ç”¨ [amis](https://aisuda.bce.baidu.com/amis/zh-CN/docs/index) ä½ä»£ç è¿›è¡Œæ„å»ºï¼Œæ–¹ä¾¿æ‰©å±•ã€‚
- ğŸ”²è®¡åˆ’å¼€å‘ä½¿ç”¨ [seekdb](https://www.oceanbase.ai/zh-CN/) AI åŸç”Ÿæ•°æ®åº“çš„ RAG åº”ç”¨åŠæ¥å£æœåŠ¡...
- ğŸ”²è®¡åˆ’æ”¯æŒRAGåº”ç”¨å’Œç›¸åº”æ¥å£...
- ğŸ”²è®¡åˆ’æ”¯æŒ prompt ç®¡ç†åŠŸèƒ½...



## æŠ€æœ¯æ ˆ

**å‰ç«¯:** amis-v6.13.0ã€TailwindCSS

**æœåŠ¡ç«¯:** FastAPI

**æ•°æ®åº“:** SQLiteã€MySQL


## Demo(åå°ç•Œé¢)

ğŸ§·[http://llmdashboard.demo.dx3906.info/dashboard/login#/api-manage](http://llmdashboard.demo.dx3906.info/dashboard/login#/api-manage)

ğŸ”‘ç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼š
```bash
test
12345678
```




## éƒ¨ç½²

é¡¹ç›®ç›®å½•è¯´æ˜
```bash
â”œâ”€â”€ app_config.yaml        # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.py              # é…ç½®åŠ è½½æ¨¡å—
â”œâ”€â”€ init.py                # æ•°æ®åº“å’Œæ¨¡å‹åˆå§‹åŒ–
â”œâ”€â”€ main_personal_llm.py   # é¡¹ç›®å…¥å£æ–‡ä»¶
â”œâ”€â”€ requirements.txt       # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ backend/               # åç«¯APIæ¨¡å—
â”‚   â”œâ”€â”€ api_manage.py      # APIç®¡ç†
â”‚   â”œâ”€â”€ backend_api.py     # åç«¯APIè·¯ç”±
â”‚   â”œâ”€â”€ chat.py            # èŠå¤©ç›¸å…³æ¥å£
â”‚   â””â”€â”€ llm_usage.py       # LLMä½¿ç”¨ç»Ÿè®¡
â”œâ”€â”€ dashboard/             # åå°ç®¡ç†ç•Œé¢
â”‚   â”œâ”€â”€ index.html         # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ login.html         # ç™»å½•é¡µé¢
â”‚   â”œâ”€â”€ reset_password.html   # é‡ç½®å¯†ç é¡µé¢
â”‚   â”œâ”€â”€ aside.json         # ä¾§è¾¹å¯¼èˆª
â”‚   â””â”€â”€ pages/             # é¡µé¢é…ç½®
â”œâ”€â”€ db/                    # æ•°æ®åº“ç›¸å…³
â”‚   â”œâ”€â”€ init_mysql.sql     # MySQLåˆå§‹åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ init_sqlite.sql    # SQLiteåˆå§‹åŒ–è„šæœ¬
â”‚   â”œâ”€â”€ llm.db             # SQLiteæ•°æ®åº“æ–‡ä»¶
â”‚   â””â”€â”€ version            # ç‰ˆæœ¬
â”œâ”€â”€ logs/                  # æ—¥å¿—æ–‡ä»¶ç›®å½•
â”œâ”€â”€ service/               # LLMæœåŠ¡å®ç°
â”‚   â”œâ”€â”€ byte_llm.py        # å­—èŠ‚è·³åŠ¨LLMæœåŠ¡
â”‚   â”œâ”€â”€ llm_service.py     # åŸºç¡€LLMæœåŠ¡
â”‚   â”œâ”€â”€ open_router_llm.py # OpenRouter LLMæœåŠ¡
â”‚   â””â”€â”€ qwen_llm.py        # é˜¿é‡Œäº‘é€šä¹‰åƒé—®æœåŠ¡
â”œâ”€â”€ static/                # é™æ€èµ„æº
â””â”€â”€ utils/                 # å·¥å…·å‡½æ•°
    â”œâ”€â”€ db_client.py       # æ•°æ®åº“å®¢æˆ·ç«¯
    â”œâ”€â”€ logger.py          # æ—¥å¿—å·¥å…·
    â”œâ”€â”€ mysql_client.py    # MySQLå®¢æˆ·ç«¯
    â”œâ”€â”€ sqlite_client.py   # SQLiteå®¢æˆ·ç«¯
    â””â”€â”€ util.py            # é€šç”¨å·¥å…·
```

ğŸ‘‰ï¸1.æ‰€éœ€ Python ç‰ˆæœ¬ï¼š
```bash
python >= 3.9
```

ğŸ‘‰ï¸2.ä½¿ç”¨ pip å®‰è£…æ‰€éœ€ Python åŒ…ï¼š

```bash
pip install -r requirements.txt
```

ğŸ‘‰ï¸3.æ ¹æ®è‡ªå·±çš„ç¯å¢ƒï¼Œä¿®æ”¹é…ç½®æ–‡ä»¶`app_config.yaml`
```bash

# æ•°æ®åº“é…ç½®
database:
  # æ•°æ®åº“ç±»å‹ï¼Œå¯é€‰ sqlite \ mysql
  # - sqlite: ä½¿ç”¨ SQLite æ•°æ®åº“ï¼Œéœ€è¦æŒ‡å®š db_path
  # - mysql: ä½¿ç”¨ MySQL æ•°æ®åº“ï¼Œéœ€è¦æŒ‡å®š host, port, user, password, database
  use_db: sqlite

  sqlite:
    db_path: ./db/llm.db

  mysql:
    host: 127.0.0.1
    port: 3306
    user: root
    password: 123
    database: db

# ä»£ç†è®¾ç½®ï¼Œç”¨äºè®¿é—®å›½å¤–å¤§æ¨¡å‹æœåŠ¡
proxy:
  # ä»£ç†ç±»å‹ï¼Œå¯é€‰ system \ manual \ none
  # - system: ä½¿ç”¨ç³»ç»Ÿä»£ç†ï¼Œè‡ªåŠ¨è·å–æ“ä½œç³»ç»Ÿä»£ç†è®¾ç½®
  # - manual: æ‰‹åŠ¨é…ç½®ä»£ç†ï¼Œéœ€è¦æŒ‡å®š url
  # - none: ä¸ä½¿ç”¨ä»£ç†
  type: none
  url: http://127.0.0.1:7890

```

ğŸ‘‰ï¸4.è¿è¡Œ main å…¥å£ Python æ–‡ä»¶ï¼š
```bash
python3 main_personal_llm.py
```
æˆ–ï¼Œä½¿ç”¨åå°è¿è¡Œæ–¹å¼
```bash
nohup python3 main_personal_llm.py &
```

ğŸ‘‰ï¸5.ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®åå°ï¼š
```bash
http://127.0.0.1:2321/dashboard
```

ğŸ‘‰ï¸6.åœ¨åå°é…ç½® LLM æä¾›å•†å’Œç›¸åº”çš„æ¨¡å‹å³å¯ï¼š

`model_name`å‚æ•°å¯é€‰ç”¨ï¼š`æ¨¡å‹åç§°`æˆ–`æ¨¡å‹ID`

![](./static/images/llm.png)


## Chat Completion æ¥å£
æ”¯æŒ`/chat/completions`æˆ–`v1/chat/completions`å¯¹è¯è¡¥å…¨æ¥å£ï¼Œå…¼å®¹æ€§æ›´å¼ºã€‚

æ”¯æŒ`Function Calling`ä»¥åŠ`web search(è”ç½‘æœç´¢)`ã€‚

æ¥å£æ–‡æ¡£å¯è¯¦è§å„å¤§å¹³å°æ–‡æ¡£ï¼š[https://api-docs.deepseek.com/zh-cn/api/create-chat-completion](https://api-docs.deepseek.com/zh-cn/api/create-chat-completion)

### ğŸŒï¸web search(è”ç½‘æœç´¢)
1. **ç«å±±äº‘(æ–¹èˆŸ)å¹³å°æ¨¡å‹**
å®˜æ–¹çš„`web search`åªæ”¯æŒ`response`æ¥å£æ–¹å¼ä½¿ç”¨ï¼Œè¯¥é¡¹ç›®çš„`/chat/completions`æ¥å£å·²å®Œæˆå…¼å®¹ï¼Œåœ¨è°ƒç”¨ç«å±±äº‘ LLM æ¨¡å‹æ¥å£æ—¶ï¼Œåªéœ€è¦é¢å¤–ä¼ å…¥`web_search=true`å‚æ•°å³å¯ä½¿ç”¨ã€‚

2. **é˜¿é‡Œäº‘(ç™¾ç‚¼)å¹³å°æ¨¡å‹**
åªéœ€è¦ä¼ å…¥`enable_search=true`å‚æ•°å³å¯ï¼Œè¯¦è§ï¼šğŸ‘‰ï¸[æ–‡æ¡£é“¾æ¥](https://help.aliyun.com/zh/model-studio/web-search?spm=a2c4g.11186623.help-menu-2400256.d_0_2_8_0.284976b8nevTcQ)

3. **OpenRouterå¹³å°æ¨¡å‹**

åªéœ€è¦åœ¨`æ¨¡å‹åç§°`æˆ–`æ¨¡å‹ID`åé¢æ·»åŠ `:online`å³å¯ï¼Œä¾‹å¦‚ï¼š
```bash
google/gemini-3-flash-preview:online
```
è¯¦è§ OpenRouter [å®˜æ–¹æ–‡æ¡£](https://openrouter.ai/docs/guides/features/plugins/web-search)


## å¯æ­é…ğŸ“ Cherry studio ä½¿ç”¨

1. åœ¨æ¨¡å‹æœåŠ¡ä¸‹è¿›è¡Œç›¸åº”é…ç½®

![](./static/images/cherry_studio.png)

2. ä¹Ÿå¯ä»¥åœ¨åŠ©æ‰‹é‡Œé…ç½®æ¯æ¬¡å¯¹è¯æ—¶é¢å¤–çš„è¯·æ±‚å‚æ•°ï¼Œä¾‹å¦‚æ§åˆ¶æ¨¡å‹çš„æ·±åº¦æ€è€ƒã€‚

![](./static/images/cherry_assistant.png)


## åå°åŠŸèƒ½å±•ç¤º

1. å¯æŸ¥çœ‹ LLM æ¥å£ä½¿ç”¨é‡å’Œç»Ÿè®¡ä¿¡æ¯

![](./static/images/llm_usage.png)

2. å¯ç®¡ç†æ¨¡å‹æ¥å£å’Œkey

3. å¯æŸ¥çœ‹å¯¹è¯å†å²è®°å½•

![](./static/images/llm_history.png)
## ä½œè€…

- [@Stark åšå®¢](http://era.dx3906.info)
- å¾®ä¿¡å…¬ä¼—å·ï¼šç¬¬äº”çºªå…ƒ
![](./static/images/wechat_group1.png)

