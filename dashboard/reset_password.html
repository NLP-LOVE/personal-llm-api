
<!DOCTYPE html>
<html dir="ltr">
    <head>
        <!-- Required meta tags -->
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Links Of CSS File -->
        <link rel="stylesheet" href="/static/login/css/remixicon.min.css">
        <link rel="stylesheet" href="/static/login/css/remixicon.css">
        <link rel="stylesheet" href="/static/login/css/apexcharts.css">
        <link rel="stylesheet" href="/static/login/css/simplebar.css">
        <link rel="stylesheet" href="/static/login/css/prism.min.css">
        <link rel="stylesheet" href="/static/login/css/jsvectormap.min.css">
        <link rel="stylesheet" href="/static/login/css/swiper-bundle.min.css">
        <link rel="stylesheet" href="/static/login/css/quill.snow.css">
        <link rel="stylesheet" href="/static/login/css/style.css">

        <!-- Favicon -->
		<link rel="icon" type="image/png" href="/static/images/favicon.png">

        <!-- Title -->
        <title>LLM后台--登录</title>

        <!-- Font Family -->
        <!-- Font Family -->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="/static/login/css/google_font_css.css" rel="stylesheet">

        <!-- Material Icons -->
        <link rel="stylesheet" href="/static/login/css/google_font_material.css" />
    </head>
    <body>

        <!-- Light/Dark Mode Button -->
        <button type="button" class="light-dark-toggle leading-none inline-block transition-all text-[#fe7a36] absolute top-[20px] md:top-[25px] ltr:right-[20px] rtl:left-[20px] ltr:md:right-[25px] rtl:md:left-[25px]" id="light-dark-toggle">
            <i class="material-symbols-outlined !text-[20px] md:!text-[22px]">
                light_mode
            </i>
        </button>
        <!-- End Light/Dark Mode Button -->

        <!-- Sign In -->
        <div class="bg-white dark:bg-[#0a0e19] py-[60px] md:py-[80px] lg:py-[135px]">
            <div class="mx-auto px-[12.5px] md:max-w-[720px] lg:max-w-[960px] xl:max-w-[1255px]">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-[25px] items-center">
                    <div class="xl:ltr:-mr-[25px] xl:rtl:-ml-[25px] 2xl:ltr:-mr-[45px] 2xl:rtl:-ml-[45px] rounded-[25px] order-2 lg:order-1">
                        <img src="/static/images/sign-in.jpg" alt="sign-in-image" class="rounded-[25px]">
                    </div>
                    <div class="xl:ltr:pl-[90px] xl:rtl:pr-[90px] 2xl:ltr:pl-[120px] 2xl:rtl:pr-[120px] order-1 lg:order-2">
                        <img src="/static/images/white-logo-big.svg" alt="logo" class="hidden dark:inline-block">
                        <div class="my-[17px] md:my-[25px]">
                            <h1 class="!font-semibold !text-[22px] md:!text-xl lg:!text-2xl !mb-[5px] md:!mb-[7px] font-sans">
                                欢迎来到 LLM dashboard!
                            </h1>
                            <p class="font-medium lg:text-md text-[#445164] dark:text-gray-400 font-sans">
                                第一次登录，需要设置新密码。
                            </p>
                        </div>
                        <div class="mb-[15px] relative" id="passwordHideShow">
                            <label class="mb-[10px] md:mb-[12px] text-black dark:text-white font-medium block font-sans">
                                新密码
                            </label>
                            <input type="password" class="font-sans h-[55px] rounded-md text-black dark:text-white border border-gray-200 dark:border-[#172036] bg-white dark:bg-[#0c1427] px-[17px] block w-full outline-0 transition-all placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:border-primary-500" id="password" placeholder="至少8位密码" autocomplete="current-password">
                            <button class="absolute text-lg ltr:right-[20px] rtl:left-[20px] bottom-[12px] transition-all hover:text-primary-500" id="toggleButton" type="button">
                                <i class="ri-eye-off-line"></i>
                            </button>
                        </div>
                        <div class="mb-[15px] relative" id="passwordHideShow2">
                            <label class="mb-[10px] md:mb-[12px] text-black dark:text-white font-medium block font-sans">
                                确认新密码
                            </label>
                            <input type="password" class="font-sans h-[55px] rounded-md text-black dark:text-white border border-gray-200 dark:border-[#172036] bg-white dark:bg-[#0c1427] px-[17px] block w-full outline-0 transition-all placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:border-primary-500" id="password_again" placeholder="至少8位密码" autocomplete="current-password">
                            <button class="absolute text-lg ltr:right-[20px] rtl:left-[20px] bottom-[12px] transition-all hover:text-primary-500" id="toggleButton" type="button">
                                <i class="ri-eye-off-line"></i>
                            </button>
                        </div>
                        <button id="loginButton" type="submit" class="md:text-md block w-full text-center transition-all rounded-md font-medium mt-[20px] md:mt-[25px] py-[12px] px-[25px] text-white bg-primary-500 hover:bg-primary-400">
                            <span class="flex items-center justify-center gap-[5px]">
                                <i class="material-symbols-outlined">
                                    login
                                </i>
                                <span class="login-btn-text font-sans">修改密码</span>
                            </span>
                        </button>
                        <p class="mt-[15px] md:mt-[20px] msg", style="color: #ff4000;">
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Sign In -->
        
        <!-- Links Of JS File -->
        <script src="/static/login/js/apexcharts.min.js"></script>
        <script src="/static/login/js/fslightbox.js"></script>
        <script src="/static/login/js/simplebar.min.js"></script>
        <script src="/static/login/js/prism.min.js"></script>
        <script src="/static/login/js/swiper-bundle.min.js"></script>
        <script src="/static/login/js/jsvectormap.min.js"></script>
        <script src="/static/login/js/world-merc.js"></script>
        <script src="/static/login/js/quill.min.js"></script>
        <script src="/static/login/js/custom.js"></script>

        <!-- 实现登录js提交操作，并且把提交错误的结果显示在msg 元素内，登录成功后把token信息放到cookie当中，并且跳转 -->
        <script>

            document.getElementById('loginButton').addEventListener('click', function() {
                const password = document.getElementById('password').value;
                const password_again = document.getElementById('password_again').value;
                const msgElement = document.querySelector('.msg');

                document.getElementsByClassName('login-btn-text')[0].innerHTML = '修改中...';
                document.getElementById('loginButton').disabled = true;

                // 模拟登录请求
                fetch('/backend/reset-password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        password: password,
                        password_again: password_again
                    })
                })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('修改失败');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.status == 0) {

                        // 跳转到目标页面
                        //随机生成一个hash值，然后跳转到目标页面
                        window.location.href = '/dashboard/home#/llm-usage';
                    } else {
                        // 显示错误信息
                        msgElement.textContent = data.msg || '修改失败，请重试';
                        document.getElementsByClassName('login-btn-text')[0].innerHTML = '修改密码';
                        document.getElementById('loginButton').disabled = false;
                    }
                })
                .catch(error => {
                    // 显示错误信息
                    msgElement.textContent = error.message || '发生未知错误，请重试';
                    document.getElementsByClassName('login-btn-text')[0].innerHTML = '修改密码';
                    document.getElementById('loginButton').disabled = false;
                });
            });
        </script>
    </body>
</html>